<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZT6JM33V5J"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-ZT6JM33V5J');
        </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Series Forecasting Explorer</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Custom theme configuration */
        body {
            font-family: 'Roboto Mono', monospace;
        }
        
        /* Custom scrollbar for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #374151;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #8b5cf6;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a78bfa;
        }
        
        /* Custom slider styles */
        .custom-slider {
            -webkit-appearance: none;
            appearance: none;
            background: #374151;
            height: 6px;
            border-radius: 3px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .custom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #8b5cf6;
            cursor: pointer;
            border: 2px solid #f3f4f6;
            transition: all 0.3s ease;
        }
        
        .custom-slider::-webkit-slider-thumb:hover {
            background: #a78bfa;
            transform: scale(1.1);
        }
        
        .custom-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #8b5cf6;
            cursor: pointer;
            border: 2px solid #f3f4f6;
            transition: all 0.3s ease;
        }
        
        /* Toggle switch styles */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #374151;
            transition: 0.3s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: #9ca3af;
            transition: 0.3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #8b5cf6;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
            background-color: #f3f4f6;
        }
        
        /* Button styles */
        .btn-primary {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #a78bfa, #c4b5fd);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #374151;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
            transform: translateY(-1px);
        }
        
        /* Model selection button styles */
        .model-btn {
            background: #374151;
            border: 2px solid #374151;
            transition: all 0.3s ease;
        }
        
        .model-btn.active {
            background: #8b5cf6;
            border-color: #8b5cf6;
            color: #f3f4f6;
        }
        
        .model-btn:hover:not(.active) {
            background: #4b5563;
            border-color: #6b7280;
        }
        
        /* Canvas styling */
        #forecastChart {
            border-radius: 8px;
            background: #101827;
            border: 1px solid #374151;
        }
        
        /* Animation classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.8s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Tooltip styles */
        .tooltip {
            position: absolute;
            background: #1f2937;
            color: #f3f4f6;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            border: 1px solid #374151;
            z-index: 1000;
            pointer-events: none;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }
        
        /* Loading animation */
        .loading-spinner {
            border: 2px solid #374151;
            border-top: 2px solid #8b5cf6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Performance metrics table */
        .metrics-table {
            background: #101827;
            border: 1px solid #374151;
            border-radius: 8px;
        }
        
        .metrics-row {
            border-bottom: 1px solid #374151;
        }
        
        .metrics-row:last-child {
            border-bottom: none;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .lg\:grid-cols-3 {
                grid-template-columns: 1fr;
            }
            
            #forecastChart {
                height: 300px !important;
            }
        }
    </style>
</head>
<body class="bg-[#101827] text-[#f3f4f6] flex flex-col min-h-screen">
    <!-- Header -->
    <header class="py-6 px-4 text-center border-b border-[#374151]">
        <h1 class="text-2xl font-bold text-[#f3f4f6]">
            Time Series Forecasting Explorer
        </h1>
    </header>

    <!-- Main Content -->
    <main class="flex-grow grid lg:grid-cols-3 gap-6 p-6">
        <!-- Control Panel (Left, 1/3 width) -->
        <div class="bg-[#1f2937] rounded-xl p-6 border border-[#374151] space-y-6">
            <!-- Dataset Selection -->
            <div>
                <h2 class="text-lg font-semibold mb-4 text-[#f3f4f6]">
                    <i class="fas fa-database text-[#8b5cf6] mr-2"></i>
                    Dataset Selection
                </h2>
                <select id="datasetSelect" class="w-full bg-[#101827] border border-[#374151] rounded-lg px-4 py-3 text-[#f3f4f6] focus:border-[#8b5cf6] focus:outline-none transition-colors">
                    <option value="airline">Airline Passengers (Seasonal)</option>
                    <option value="stock">Tech Stock Prices (Trended)</option>
                    <option value="traffic">Website Traffic (Noisy)</option>
                    <option value="retail">Retail Sales (Seasonal + Trend)</option>
                </select>
            </div>

            <!-- Model Selection -->
            <div>
                <h2 class="text-lg font-semibold mb-4 text-[#f3f4f6]">
                    <i class="fas fa-brain text-[#8b5cf6] mr-2"></i>
                    Model Selection
                </h2>
                <div class="space-y-2">
                    <button id="arimaBtn" class="model-btn w-full py-3 px-4 rounded-lg font-medium text-[#9ca3af] flex items-center justify-center active">
                        <i class="fas fa-chart-line mr-2"></i>
                        ARIMA
                    </button>
                    <button id="prophetBtn" class="model-btn w-full py-3 px-4 rounded-lg font-medium text-[#9ca3af] flex items-center justify-center">
                        <i class="fas fa-magic mr-2"></i>
                        Prophet
                    </button>
                    <button id="expSmoothBtn" class="model-btn w-full py-3 px-4 rounded-lg font-medium text-[#9ca3af] flex items-center justify-center">
                        <i class="fas fa-wave-square mr-2"></i>
                        Exponential Smoothing
                    </button>
                </div>
            </div>

            <!-- Model Parameters -->
            <div>
                <h2 class="text-lg font-semibold mb-4 text-[#f3f4f6]">
                    <i class="fas fa-sliders-h text-[#8b5cf6] mr-2"></i>
                    Model Parameters
                </h2>
                
                <!-- ARIMA Parameters -->
                <div id="arimaParams" class="space-y-4">
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-[#f3f4f6]">p (AutoRegressive)</label>
                            <span id="pValue" class="text-xs text-[#9ca3af]">1</span>
                        </div>
                        <input type="range" id="pSlider" class="custom-slider w-full" min="0" max="5" step="1" value="1">
                        <div class="flex justify-between text-xs text-[#9ca3af] mt-1">
                            <span>0</span>
                            <span>5</span>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-[#f3f4f6]">d (Differencing)</label>
                            <span id="dValue" class="text-xs text-[#9ca3af]">1</span>
                        </div>
                        <input type="range" id="dSlider" class="custom-slider w-full" min="0" max="2" step="1" value="1">
                        <div class="flex justify-between text-xs text-[#9ca3af] mt-1">
                            <span>0</span>
                            <span>2</span>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-[#f3f4f6]">q (Moving Average)</label>
                            <span id="qValue" class="text-xs text-[#9ca3af]">1</span>
                        </div>
                        <input type="range" id="qSlider" class="custom-slider w-full" min="0" max="5" step="1" value="1">
                        <div class="flex justify-between text-xs text-[#9ca3af] mt-1">
                            <span>0</span>
                            <span>5</span>
                        </div>
                    </div>
                </div>

                <!-- Prophet Parameters -->
                <div id="prophetParams" class="space-y-4" style="display: none;">
                    <div class="flex items-center justify-between">
                        <label class="text-sm font-medium text-[#f3f4f6]">Seasonality</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="seasonalityToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <label class="text-sm font-medium text-[#f3f4f6]">Holidays</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="holidaysToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Exponential Smoothing Parameters -->
                <div id="expSmoothParams" class="space-y-4" style="display: none;">
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-[#f3f4f6]">Alpha (Smoothing)</label>
                            <span id="alphaValue" class="text-xs text-[#9ca3af]">0.3</span>
                        </div>
                        <input type="range" id="alphaSlider" class="custom-slider w-full" min="0.1" max="1.0" step="0.1" value="0.3">
                        <div class="flex justify-between text-xs text-[#9ca3af] mt-1">
                            <span>0.1</span>
                            <span>1.0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="space-y-3">
                <button 
                    id="generateBtn" 
                    class="btn-primary w-full py-3 px-4 rounded-lg font-medium text-white flex items-center justify-center"
                >
                    <i class="fas fa-play mr-2"></i>
                    Generate Forecast
                </button>
                
                <button 
                    id="resetBtn" 
                    class="btn-secondary w-full py-3 px-4 rounded-lg font-medium text-[#f3f4f6] flex items-center justify-center"
                >
                    <i class="fas fa-undo mr-2"></i>
                    Reset View
                </button>
            </div>

            <!-- Current Configuration Info -->
            <div class="bg-[#101827] border border-[#374151] rounded-lg p-4">
                <h4 class="text-sm font-semibold text-[#a78bfa] mb-2">
                    <i class="fas fa-info-circle mr-1"></i>
                    Current Configuration
                </h4>
                <div id="configInfo" class="text-xs text-[#9ca3af] space-y-1">
                    <div>Dataset: <span class="text-[#f3f4f6]">Airline Passengers</span></div>
                    <div>Model: <span class="text-[#f3f4f6]">ARIMA(1,1,1)</span></div>
                    <div>Status: <span class="text-[#f59e0b]">Ready to forecast</span></div>
                </div>
            </div>
        </div>

        <!-- Visualization Panel (Right, 2/3 width) -->
        <div class="lg:col-span-2 bg-[#1f2937] rounded-xl p-6 border border-[#374151]">
            <div class="h-full flex flex-col">
                <!-- Chart Header -->
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold text-[#f3f4f6]">
                        <i class="fas fa-chart-area text-[#8b5cf6] mr-2"></i>
                        Time Series Forecast
                    </h2>
                    <div class="flex items-center space-x-4 text-xs">
                        <div class="flex items-center">
                            <div class="w-4 h-1 bg-[#9ca3af] mr-2"></div>
                            <span class="text-[#9ca3af]">Historical</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-1 bg-[#8b5cf6] mr-2" style="border: 1px dashed #8b5cf6; background: none;"></div>
                            <span class="text-[#9ca3af]">Forecast</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-1 bg-[#8b5cf6] opacity-30 mr-2"></div>
                            <span class="text-[#9ca3af]">Confidence</span>
                        </div>
                    </div>
                </div>
                
                <!-- Main Chart -->
                <div class="flex-grow mb-6">
                    <canvas 
                        id="forecastChart" 
                        class="w-full" 
                        style="height: 400px;"
                    ></canvas>
                </div>

                <!-- Performance Metrics -->
                <div>
                    <h3 class="text-sm font-semibold text-[#f3f4f6] mb-3">
                        <i class="fas fa-analytics text-[#8b5cf6] mr-2"></i>
                        Performance Metrics
                    </h3>
                    <div class="metrics-table">
                        <div class="grid grid-cols-4 gap-4 p-4">
                            <div class="text-center">
                                <div class="text-xs text-[#9ca3af] mb-1">Model</div>
                                <div id="currentModel" class="text-sm font-medium text-[#f3f4f6]">ARIMA</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-[#9ca3af] mb-1">MAE</div>
                                <div id="maeValue" class="text-sm font-medium text-[#f3f4f6]">--</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-[#9ca3af] mb-1">RMSE</div>
                                <div id="rmseValue" class="text-sm font-medium text-[#f3f4f6]">--</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-[#9ca3af] mb-1">R²</div>
                                <div id="r2Value" class="text-sm font-medium text-[#f3f4f6]">--</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-[#1f2937] border-t border-[#374151] py-6 mt-auto">
        <div class="flex justify-center space-x-6">
            <a href="https://www.linkedin.com/in/ashish-jangra/" target="_blank" rel="noopener noreferrer" 
               class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors duration-300">
                <i class="fab fa-linkedin fa-2x"></i>
            </a>
            <a href="https://github.com/AshishJangra27" target="_blank" rel="noopener noreferrer" 
               class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors duration-300">
                <i class="fab fa-github fa-2x"></i>
            </a>
            <a href="https://www.kaggle.com/ashishjangra27" target="_blank" rel="noopener noreferrer" 
               class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors duration-300">
                <i class="fab fa-kaggle fa-2x"></i>
            </a>
            <a href="https://huggingface.co/ashish-jangra" target="_blank" rel="noopener noreferrer" 
               class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors duration-300">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.036 3L4.5 7.73v8.54l7.536 4.73 7.536-4.73V7.73L12.036 3zm5.157 3.74L12 10.5 6.807 6.74 12 4.73l5.193 2.01zm-5.157 12.72l-5.036-3.16V9.04L12 13.08l5.036-4.04v7.26L12.036 19.46z"/>
                </svg>
            </a>
            <a href="https://www.instagram.com/ashish_zangra/" target="_blank" rel="noopener noreferrer" 
               class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors duration-300">
                <i class="fab fa-instagram fa-2x"></i>
            </a>
        </div>
    </footer>

    <script>
        // Global variables
        let currentDataset = 'airline';
        let currentModel = 'arima';
        let currentParams = {
            arima: { p: 1, d: 1, q: 1 },
            prophet: { seasonality: true, holidays: true },
            expSmooth: { alpha: 0.3 }
        };
        let chartData = [];
        let forecastData = [];
        let tooltip = null;
        let chartCtx = null;
        
        // Datasets
        const datasets = {
            airline: {
                name: 'Airline Passengers',
                data: generateAirlineData(),
                description: 'Monthly airline passenger numbers with strong seasonal patterns'
            },
            stock: {
                name: 'Tech Stock Prices',
                data: generateStockData(),
                description: 'Daily stock prices with trending behavior and volatility'
            },
            traffic: {
                name: 'Website Traffic',
                data: generateTrafficData(),
                description: 'Daily website visitors with noise and weekly patterns'
            },
            retail: {
                name: 'Retail Sales',
                data: generateRetailData(),
                description: 'Monthly retail sales with both trend and seasonal components'
            }
        };
        
        // Initialize application
        function init() {
            setupCanvas();
            setupEventListeners();
            setupTooltip();
            loadDataset();
            updateDisplay();
        }
        
        // Setup canvas
        function setupCanvas() {
            const canvas = document.getElementById('forecastChart');
            chartCtx = canvas.getContext('2d');
            
            // Set canvas size for high DPI displays
            const rect = canvas.getBoundingClientRect();
            const dpr = window.devicePixelRatio || 1;
            
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            
            chartCtx.scale(dpr, dpr);
            
            // Setup mouse events
            canvas.addEventListener('mousemove', handleCanvasMouseMove);
            canvas.addEventListener('mouseleave', hideTooltip);
        }
        
        // Setup tooltip
        function setupTooltip() {
            tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            tooltip.style.display = 'none';
            document.body.appendChild(tooltip);
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Dataset selection
            document.getElementById('datasetSelect').addEventListener('change', (e) => {
                currentDataset = e.target.value;
                loadDataset();
                clearForecast();
                updateDisplay();
            });
            
            // Model selection
            document.getElementById('arimaBtn').addEventListener('click', () => selectModel('arima'));
            document.getElementById('prophetBtn').addEventListener('click', () => selectModel('prophet'));
            document.getElementById('expSmoothBtn').addEventListener('click', () => selectModel('expSmooth'));
            
            // ARIMA parameter sliders
            setupSlider('pSlider', 'pValue', (value) => {
                currentParams.arima.p = parseInt(value);
                updateConfigInfo();
            });
            
            setupSlider('dSlider', 'dValue', (value) => {
                currentParams.arima.d = parseInt(value);
                updateConfigInfo();
            });
            
            setupSlider('qSlider', 'qValue', (value) => {
                currentParams.arima.q = parseInt(value);
                updateConfigInfo();
            });
            
            // Prophet toggles
            document.getElementById('seasonalityToggle').addEventListener('change', (e) => {
                currentParams.prophet.seasonality = e.target.checked;
                updateConfigInfo();
            });
            
            document.getElementById('holidaysToggle').addEventListener('change', (e) => {
                currentParams.prophet.holidays = e.target.checked;
                updateConfigInfo();
            });
            
            // Exponential Smoothing slider
            setupSlider('alphaSlider', 'alphaValue', (value) => {
                currentParams.expSmooth.alpha = parseFloat(value);
                updateConfigInfo();
            });
            
            // Action buttons
            document.getElementById('generateBtn').addEventListener('click', generateForecast);
            document.getElementById('resetBtn').addEventListener('click', resetView);
            
            // Window resize
            window.addEventListener('resize', debounce(() => {
                setupCanvas();
                updateDisplay();
            }, 250));
        }
        
        // Setup slider with value display
        function setupSlider(sliderId, valueId, callback) {
            const slider = document.getElementById(sliderId);
            const valueDisplay = document.getElementById(valueId);
            
            slider.addEventListener('input', (e) => {
                const value = e.target.value;
                valueDisplay.textContent = value;
                callback(value);
            });
        }
        
        // Select model
        function selectModel(model) {
            currentModel = model;
            
            // Update button states
            document.querySelectorAll('.model-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(model + 'Btn').classList.add('active');
            
            // Show/hide parameter sections
            document.getElementById('arimaParams').style.display = model === 'arima' ? 'block' : 'none';
            document.getElementById('prophetParams').style.display = model === 'prophet' ? 'block' : 'none';
            document.getElementById('expSmoothParams').style.display = model === 'expSmooth' ? 'block' : 'none';
            
            clearForecast();
            updateConfigInfo();
            updateDisplay();
        }
        
        // Load current dataset
        function loadDataset() {
            chartData = datasets[currentDataset].data;
        }
        
        // Generate synthetic airline data
        function generateAirlineData() {
            const data = [];
            const startDate = new Date('2020-01-01');
            
            for (let i = 0; i < 48; i++) {
                const date = new Date(startDate);
                date.setMonth(date.getMonth() + i);
                
                // Base trend
                const trend = 100 + i * 3;
                
                // Seasonal component (summer peak)
                const month = date.getMonth();
                const seasonal = Math.sin(2 * Math.PI * month / 12) * 40;
                
                // Noise
                const noise = (Math.random() - 0.5) * 20;
                
                const value = Math.max(0, trend + seasonal + noise);
                
                data.push({
                    date: new Date(date),
                    value: Math.round(value)
                });
            }
            
            return data;
        }
        
        // Generate synthetic stock data
        function generateStockData() {
            const data = [];
            const startDate = new Date('2023-01-01');
            let price = 100;
            
            for (let i = 0; i < 365; i++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + i);
                
                // Random walk with slight upward trend
                const change = (Math.random() - 0.48) * 5; // Slight bias upward
                price = Math.max(10, price + change);
                
                data.push({
                    date: new Date(date),
                    value: Math.round(price * 100) / 100
                });
            }
            
            return data;
        }
        
        // Generate synthetic traffic data
        function generateTrafficData() {
            const data = [];
            const startDate = new Date('2023-01-01');
            
            for (let i = 0; i < 365; i++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + i);
                
                // Base level with growth
                const base = 1000 + i * 2;
                
                // Weekly pattern (lower on weekends)
                const dayOfWeek = date.getDay();
                const weekly = dayOfWeek === 0 || dayOfWeek === 6 ? -200 : 100;
                
                // High noise
                const noise = (Math.random() - 0.5) * 300;
                
                const value = Math.max(100, base + weekly + noise);
                
                data.push({
                    date: new Date(date),
                    value: Math.round(value)
                });
            }
            
            return data;
        }
        
        // Generate synthetic retail data
        function generateRetailData() {
            const data = [];
            const startDate = new Date('2020-01-01');
            
            for (let i = 0; i < 48; i++) {
                const date = new Date(startDate);
                date.setMonth(date.getMonth() + i);
                
                // Trend component
                const trend = 50000 + i * 1000;
                
                // Seasonal component (holiday boost in Q4)
                const month = date.getMonth();
                const seasonal = month >= 10 ? 20000 : 0; // Nov-Dec boost
                
                // Annual pattern
                const annual = Math.sin(2 * Math.PI * month / 12) * 5000;
                
                // Noise
                const noise = (Math.random() - 0.5) * 8000;
                
                const value = Math.max(10000, trend + seasonal + annual + noise);
                
                data.push({
                    date: new Date(date),
                    value: Math.round(value)
                });
            }
            
            return data;
        }
        
        // Generate forecast based on current model and parameters
        function generateForecast() {
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.innerHTML = '<div class="loading-spinner mr-2"></div>Generating...';
            
            setTimeout(() => {
                switch (currentModel) {
                    case 'arima':
                        forecastData = generateARIMAForecast();
                        break;
                    case 'prophet':
                        forecastData = generateProphetForecast();
                        break;
                    case 'expSmooth':
                        forecastData = generateExpSmoothForecast();
                        break;
                }
                
                calculateMetrics();
                updateDisplay();
                updateConfigInfo();
                
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-play mr-2"></i>Generate Forecast';
            }, 1500);
        }
        
        // Generate ARIMA forecast simulation
        function generateARIMAForecast() {
            const { p, d, q } = currentParams.arima;
            const forecast = [];
            const forecastPeriods = 12;
            
            // Simplified ARIMA simulation
            const values = chartData.map(d => d.value);
            const lastValue = values[values.length - 1];
            
            for (let i = 0; i < forecastPeriods; i++) {
                const date = new Date(chartData[chartData.length - 1].date);
                if (currentDataset === 'stock' || currentDataset === 'traffic') {
                    date.setDate(date.getDate() + i + 1);
                } else {
                    date.setMonth(date.getMonth() + i + 1);
                }
                
                // Simple trend + noise simulation
                const trend = lastValue + (i * 2);
                const arEffect = (Math.random() - 0.5) * 20 * (p / 5);
                const maEffect = (Math.random() - 0.5) * 15 * (q / 5);
                const diffEffect = (d > 0) ? (Math.random() - 0.5) * 10 : 0;
                
                const forecast_value = trend + arEffect + maEffect + diffEffect;
                const uncertainty = 10 + i * 3;
                
                forecast.push({
                    date: new Date(date),
                    value: Math.max(0, forecast_value),
                    lower: Math.max(0, forecast_value - uncertainty),
                    upper: forecast_value + uncertainty
                });
            }
            
            return forecast;
        }
        
        // Generate Prophet forecast simulation
        function generateProphetForecast() {
            const { seasonality, holidays } = currentParams.prophet;
            const forecast = [];
            const forecastPeriods = 12;
            
            const values = chartData.map(d => d.value);
            const lastValue = values[values.length - 1];
            
            for (let i = 0; i < forecastPeriods; i++) {
                const date = new Date(chartData[chartData.length - 1].date);
                if (currentDataset === 'stock' || currentDataset === 'traffic') {
                    date.setDate(date.getDate() + i + 1);
                } else {
                    date.setMonth(date.getMonth() + i + 1);
                }
                
                // Trend component
                const trend = lastValue + (i * 1.5);
                
                // Seasonal component
                let seasonal = 0;
                if (seasonality) {
                    if (currentDataset === 'airline' || currentDataset === 'retail') {
                        seasonal = Math.sin(2 * Math.PI * date.getMonth() / 12) * 20;
                    } else {
                        seasonal = Math.sin(2 * Math.PI * date.getDay() / 7) * 15;
                    }
                }
                
                // Holiday effect
                let holiday = 0;
                if (holidays && (date.getMonth() === 11 || date.getMonth() === 0)) {
                    holiday = 30;
                }
                
                const forecast_value = trend + seasonal + holiday;
                const uncertainty = 8 + i * 2;
                
                forecast.push({
                    date: new Date(date),
                    value: Math.max(0, forecast_value),
                    lower: Math.max(0, forecast_value - uncertainty),
                    upper: forecast_value + uncertainty
                });
            }
            
            return forecast;
        }
        
        // Generate Exponential Smoothing forecast simulation
        function generateExpSmoothForecast() {
            const { alpha } = currentParams.expSmooth;
            const forecast = [];
            const forecastPeriods = 12;
            
            const values = chartData.map(d => d.value);
            let smoothed = values[values.length - 1];
            
            for (let i = 0; i < forecastPeriods; i++) {
                const date = new Date(chartData[chartData.length - 1].date);
                if (currentDataset === 'stock' || currentDataset === 'traffic') {
                    date.setDate(date.getDate() + i + 1);
                } else {
                    date.setMonth(date.getMonth() + i + 1);
                }
                
                // Exponential smoothing (simplified)
                const noise = (Math.random() - 0.5) * 10;
                smoothed = alpha * (smoothed + noise) + (1 - alpha) * smoothed;
                
                const uncertainty = 15 + i * 4;
                
                forecast.push({
                    date: new Date(date),
                    value: Math.max(0, smoothed),
                    lower: Math.max(0, smoothed - uncertainty),
                    upper: smoothed + uncertainty
                });
            }
            
            return forecast;
        }
        
        // Calculate performance metrics
        function calculateMetrics() {
            if (forecastData.length === 0) return;
            
            // Use the last part of historical data to simulate test set
            const testSize = Math.min(12, Math.floor(chartData.length * 0.2));
            const testData = chartData.slice(-testSize);
            const simulated = forecastData.slice(0, testSize);
            
            let mae = 0, rmse = 0, actualMean = 0;
            
            for (let i = 0; i < Math.min(testData.length, simulated.length); i++) {
                const actual = testData[i].value;
                const predicted = simulated[i].value;
                const error = Math.abs(actual - predicted);
                
                mae += error;
                rmse += error * error;
                actualMean += actual;
            }
            
            const n = Math.min(testData.length, simulated.length);
            mae = mae / n;
            rmse = Math.sqrt(rmse / n);
            actualMean = actualMean / n;
            
            // Calculate R² (simplified)
            let ss_res = 0, ss_tot = 0;
            for (let i = 0; i < n; i++) {
                const actual = testData[i].value;
                const predicted = simulated[i].value;
                ss_res += Math.pow(actual - predicted, 2);
                ss_tot += Math.pow(actual - actualMean, 2);
            }
            
            const r2 = Math.max(0, 1 - (ss_res / ss_tot));
            
            // Update display
            document.getElementById('maeValue').textContent = mae.toFixed(2);
            document.getElementById('rmseValue').textContent = rmse.toFixed(2);
            document.getElementById('r2Value').textContent = r2.toFixed(3);
        }
        
        // Clear forecast
        function clearForecast() {
            forecastData = [];
            document.getElementById('maeValue').textContent = '--';
            document.getElementById('rmseValue').textContent = '--';
            document.getElementById('r2Value').textContent = '--';
        }
        
        // Update display
        function updateDisplay() {
            drawChart();
            updateConfigInfo();
        }
        
        // Draw chart
        function drawChart() {
            const canvas = document.getElementById('forecastChart');
            const ctx = chartCtx;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (chartData.length === 0) return;
            
            const rect = canvas.getBoundingClientRect();
            const width = rect.width;
            const height = rect.height;
            
            // Combine historical and forecast data for scaling
            const allData = [...chartData, ...forecastData];
            const dates = allData.map(d => d.date.getTime());
            const values = allData.map(d => d.value);
            
            if (forecastData.length > 0) {
                const bounds = forecastData.flatMap(d => [d.lower, d.upper]);
                values.push(...bounds);
            }
            
            const minDate = Math.min(...dates);
            const maxDate = Math.max(...dates);
            const minValue = Math.min(...values) * 0.95;
            const maxValue = Math.max(...values) * 1.05;
            
            // Helper functions
            const xScale = (date) => ((date - minDate) / (maxDate - minDate)) * (width - 80) + 40;
            const yScale = (value) => height - 40 - ((value - minValue) / (maxValue - minValue)) * (height - 80);
            
            // Draw grid
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 1;
            
            // Vertical grid lines
            for (let i = 0; i <= 8; i++) {
                const x = 40 + (i / 8) * (width - 80);
                ctx.beginPath();
                ctx.moveTo(x, 40);
                ctx.lineTo(x, height - 40);
                ctx.stroke();
            }
            
            // Horizontal grid lines
            for (let i = 0; i <= 6; i++) {
                const y = 40 + (i / 6) * (height - 80);
                ctx.beginPath();
                ctx.moveTo(40, y);
                ctx.lineTo(width - 40, y);
                ctx.stroke();
            }
            
            // Draw confidence interval
            if (forecastData.length > 0) {
                ctx.fillStyle = 'rgba(139, 92, 246, 0.2)';
                ctx.beginPath();
                
                // Upper bound
                forecastData.forEach((d, i) => {
                    const x = xScale(d.date.getTime());
                    const y = yScale(d.upper);
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                
                // Lower bound (reverse order)
                for (let i = forecastData.length - 1; i >= 0; i--) {
                    const d = forecastData[i];
                    const x = xScale(d.date.getTime());
                    const y = yScale(d.lower);
                    ctx.lineTo(x, y);
                }
                
                ctx.closePath();
                ctx.fill();
            }
            
            // Draw historical data
            ctx.strokeStyle = '#9ca3af';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            chartData.forEach((d, i) => {
                const x = xScale(d.date.getTime());
                const y = yScale(d.value);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            
            ctx.stroke();
            
            // Draw forecast line
            if (forecastData.length > 0) {
                ctx.strokeStyle = '#8b5cf6';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                
                // Connect to last historical point
                const lastHistorical = chartData[chartData.length - 1];
                ctx.moveTo(xScale(lastHistorical.date.getTime()), yScale(lastHistorical.value));
                
                forecastData.forEach(d => {
                    const x = xScale(d.date.getTime());
                    const y = yScale(d.value);
                    ctx.lineTo(x, y);
                });
                
                ctx.stroke();
                ctx.setLineDash([]);
            }
            
            // Draw axes labels
            ctx.fillStyle = '#9ca3af';
            ctx.font = '12px Roboto Mono';
            
            // Y-axis labels
            for (let i = 0; i <= 6; i++) {
                const value = minValue + (i / 6) * (maxValue - minValue);
                const y = height - 40 - (i / 6) * (height - 80);
                ctx.textAlign = 'right';
                ctx.fillText(Math.round(value).toLocaleString(), 35, y + 4);
            }
            
            // X-axis labels
            ctx.textAlign = 'center';
            for (let i = 0; i <= 4; i++) {
                const dateTime = minDate + (i / 4) * (maxDate - minDate);
                const date = new Date(dateTime);
                const x = 40 + (i / 4) * (width - 80);
                
                let dateStr;
                if (currentDataset === 'stock' || currentDataset === 'traffic') {
                    dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                } else {
                    dateStr = date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' });
                }
                
                ctx.fillText(dateStr, x, height - 20);
            }
        }
        
        // Handle canvas mouse move
        function handleCanvasMouseMove(event) {
            const canvas = event.target;
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            
            // Find closest data point
            const allData = [...chartData, ...forecastData];
            if (allData.length === 0) return;
            
            const dates = allData.map(d => d.date.getTime());
            const minDate = Math.min(...dates);
            const maxDate = Math.max(...dates);
            
            const dateAtX = minDate + ((x - 40) / (rect.width - 80)) * (maxDate - minDate);
            
            // Find closest point
            let closestPoint = null;
            let minDistance = Infinity;
            let isHistorical = false;
            
            chartData.forEach(d => {
                const distance = Math.abs(d.date.getTime() - dateAtX);
                if (distance < minDistance) {
                    minDistance = distance;
                    closestPoint = d;
                    isHistorical = true;
                }
            });
            
            forecastData.forEach(d => {
                const distance = Math.abs(d.date.getTime() - dateAtX);
                if (distance < minDistance) {
                    minDistance = distance;
                    closestPoint = d;
                    isHistorical = false;
                }
            });
            
            if (closestPoint) {
                showTooltip(event.clientX, event.clientY, closestPoint, isHistorical);
            }
        }
        
        // Show tooltip
        function showTooltip(x, y, point, isHistorical) {
            const date = point.date.toLocaleDateString();
            const value = Math.round(point.value);
            
            let content = `<div><strong>${date}</strong></div>`;
            content += `<div>${isHistorical ? 'Historical' : 'Forecast'}: ${value.toLocaleString()}</div>`;
            
            if (!isHistorical && point.lower !== undefined) {
                content += `<div>Range: ${Math.round(point.lower).toLocaleString()} - ${Math.round(point.upper).toLocaleString()}</div>`;
            }
            
            tooltip.innerHTML = content;
            tooltip.style.display = 'block';
            tooltip.style.left = (x + 10) + 'px';
            tooltip.style.top = (y - 10) + 'px';
        }
        
        // Hide tooltip
        function hideTooltip() {
            tooltip.style.display = 'none';
        }
        
        // Update configuration info
        function updateConfigInfo() {
            const dataset = datasets[currentDataset];
            const configInfo = document.getElementById('configInfo');
            
            let modelText = '';
            switch (currentModel) {
                case 'arima':
                    const { p, d, q } = currentParams.arima;
                    modelText = `ARIMA(${p},${d},${q})`;
                    break;
                case 'prophet':
                    modelText = 'Prophet';
                    break;
                case 'expSmooth':
                    modelText = 'Exponential Smoothing';
                    break;
            }
            
            const status = forecastData.length > 0 ? 'Forecast generated' : 'Ready to forecast';
            const statusColor = forecastData.length > 0 ? '#10b981' : '#f59e0b';
            
            configInfo.innerHTML = `
                <div>Dataset: <span class="text-[#f3f4f6]">${dataset.name}</span></div>
                <div>Model: <span class="text-[#f3f4f6]">${modelText}</span></div>
                <div>Status: <span style="color: ${statusColor}">${status}</span></div>
            `;
            
            document.getElementById('currentModel').textContent = modelText;
        }
        
        // Reset view
        function resetView() {
            clearForecast();
            
            // Reset parameters to defaults
            currentParams = {
                arima: { p: 1, d: 1, q: 1 },
                prophet: { seasonality: true, holidays: true },
                expSmooth: { alpha: 0.3 }
            };
            
            // Reset UI controls
            document.getElementById('pSlider').value = 1;
            document.getElementById('pValue').textContent = '1';
            document.getElementById('dSlider').value = 1;
            document.getElementById('dValue').textContent = '1';
            document.getElementById('qSlider').value = 1;
            document.getElementById('qValue').textContent = '1';
            
            document.getElementById('seasonalityToggle').checked = true;
            document.getElementById('holidaysToggle').checked = true;
            
            document.getElementById('alphaSlider').value = 0.3;
            document.getElementById('alphaValue').textContent = '0.3';
            
            updateDisplay();
        }
        
        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
