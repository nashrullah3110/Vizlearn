<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duplicate Values Handling Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Roboto Mono', monospace;
        }
        .data-row {
            transition: all 0.3s ease;
        }
        .data-row.duplicate {
            background-color: #dc2626;
            color: #fef2f2;
        }
        .data-row.unique {
            background-color: #059669;
            color: #f0fdf4;
        }
        .data-row.kept {
            background-color: #0ea5e9;
            color: #f0f9ff;
        }
        .data-row.removed {
            background-color: #6b7280;
            color: #f9fafb;
            opacity: 0.5;
            text-decoration: line-through;
        }
        .strategy-button.active {
            background-color: #8b5cf6;
            color: #f3f4f6;
        }
        .duplicate-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .duplicate-group-1 { background-color: #ef4444; }
        .duplicate-group-2 { background-color: #f97316; }
        .duplicate-group-3 { background-color: #eab308; }
        .duplicate-group-4 { background-color: #22c55e; }
        .duplicate-group-5 { background-color: #3b82f6; }
        .duplicate-group-6 { background-color: #a855f7; }
        .visualization-bar {
            transition: all 0.5s ease;
        }
        .highlight-animation {
            animation: highlight 1s ease-in-out;
        }
        @keyframes highlight {
            0%, 100% { background-color: transparent; }
            50% { background-color: #8b5cf6; }
        }
    </style>
</head>
<body class="bg-[#101827] text-[#f3f4f6] min-h-screen flex flex-col">
    <!-- Header -->
    <header class="bg-[#1f2937] border-b border-[#374151] py-4 px-6">
        <h1 class="text-2xl font-bold text-center">Duplicate Values Handling Explorer</h1>
    </header>

    <!-- Main Content -->
    <main class="flex-grow p-6 grid grid-cols-1 lg:grid-cols-12 gap-6">
        <!-- Control Panel -->
        <div class="lg:col-span-4 bg-[#1f2937] rounded-lg p-6 border border-[#374151] h-fit">
            <h2 class="text-lg font-bold mb-4 text-[#8b5cf6]">Data Configuration</h2>
            
            <!-- Dataset Size -->
            <div class="mb-6">
                <label class="block text-sm font-medium mb-2">Dataset Size:</label>
                <div class="flex space-x-2">
                    <input type="range" id="rowSlider" min="10" max="50" value="20" class="flex-grow">
                    <span id="rowCount" class="text-[#9ca3af] text-sm w-8">20</span>
                </div>
            </div>

            <!-- Duplicate Percentage -->
            <div class="mb-6">
                <label class="block text-sm font-medium mb-2">Duplicate Percentage:</label>
                <div class="flex space-x-2">
                    <input type="range" id="duplicateSlider" min="10" max="60" value="30" class="flex-grow">
                    <span id="duplicatePercent" class="text-[#9ca3af] text-sm w-12">30%</span>
                </div>
            </div>

            <!-- Detection Criteria -->
            <div class="mb-6">
                <label class="block text-sm font-medium mb-2">Detection Based On:</label>
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="checkbox" id="checkName" checked class="mr-2 accent-[#8b5cf6]">
                        <span class="text-sm">Name</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="checkEmail" checked class="mr-2 accent-[#8b5cf6]">
                        <span class="text-sm">Email</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="checkPhone" class="mr-2 accent-[#8b5cf6]">
                        <span class="text-sm">Phone</span>
                    </label>
                </div>
            </div>

            <!-- Strategy Selection -->
            <div class="mb-6">
                <label class="block text-sm font-medium mb-2">Handling Strategy:</label>
                <div class="space-y-2">
                    <button id="keepFirstStrategy" class="strategy-button w-full text-left px-3 py-2 rounded border border-[#374151] hover:bg-[#8b5cf6] hover:text-[#f3f4f6] transition-colors">
                        <i class="fas fa-arrow-up mr-2"></i>Keep First Occurrence
                    </button>
                    <button id="keepLastStrategy" class="strategy-button w-full text-left px-3 py-2 rounded border border-[#374151] hover:bg-[#8b5cf6] hover:text-[#f3f4f6] transition-colors">
                        <i class="fas fa-arrow-down mr-2"></i>Keep Last Occurrence
                    </button>
                    <button id="keepCompleteStrategy" class="strategy-button w-full text-left px-3 py-2 rounded border border-[#374151] hover:bg-[#8b5cf6] hover:text-[#f3f4f6] transition-colors">
                        <i class="fas fa-check-circle mr-2"></i>Keep Most Complete
                    </button>
                    <button id="removeAllStrategy" class="strategy-button w-full text-left px-3 py-2 rounded border border-[#374151] hover:bg-[#8b5cf6] hover:text-[#f3f4f6] transition-colors">
                        <i class="fas fa-trash mr-2"></i>Remove All Duplicates
                    </button>
                    <button id="mergeStrategy" class="strategy-button w-full text-left px-3 py-2 rounded border border-[#374151] hover:bg-[#8b5cf6] hover:text-[#f3f4f6] transition-colors">
                        <i class="fas fa-compress-arrows-alt mr-2"></i>Merge Information
                    </button>
                </div>
            </div>

            <!-- Control Buttons -->
            <div class="space-y-2">
                <button id="generateBtn" class="w-full bg-[#8b5cf6] hover:bg-[#a78bfa] text-white py-2 px-4 rounded transition-colors">
                    <i class="fas fa-dice mr-2"></i>Generate New Data
                </button>
                <button id="detectBtn" class="w-full bg-[#f59e0b] hover:bg-[#fbbf24] text-white py-2 px-4 rounded transition-colors">
                    <i class="fas fa-search mr-2"></i>Detect Duplicates
                </button>
                <button id="applyBtn" class="w-full bg-[#059669] hover:bg-[#10b981] text-white py-2 px-4 rounded transition-colors">
                    <i class="fas fa-play mr-2"></i>Apply Strategy
                </button>
                <button id="resetBtn" class="w-full bg-[#dc2626] hover:bg-[#ef4444] text-white py-2 px-4 rounded transition-colors">
                    <i class="fas fa-undo mr-2"></i>Reset
                </button>
            </div>

            <!-- Statistics -->
            <div id="statistics" class="mt-6 p-4 bg-[#101827] rounded border border-[#374151]">
                <h3 class="text-sm font-bold mb-2 text-[#8b5cf6]">Statistics</h3>
                <div class="text-xs space-y-1 text-[#9ca3af]">
                    <div>Total Records: <span id="totalRecords">20</span></div>
                    <div>Duplicate Groups: <span id="duplicateGroups">0</span></div>
                    <div>Duplicate Records: <span id="duplicateRecords">0</span></div>
                    <div>After Cleanup: <span id="afterCleanup">20</span></div>
                    <div>Data Reduction: <span id="dataReduction">0%</span></div>
                </div>
            </div>
        </div>

        <!-- Data Visualization -->
        <div class="lg:col-span-8 bg-[#1f2937] rounded-lg p-6 border border-[#374151]">
            <h2 class="text-lg font-bold mb-4 text-[#8b5cf6]">Data Visualization</h2>
            
            <!-- Dataset Table -->
            <div class="mb-6">
                <h3 class="text-sm font-medium mb-2">Dataset Table</h3>
                <div class="overflow-x-auto max-h-96 overflow-y-auto">
                    <table class="w-full text-xs">
                        <thead class="sticky top-0 bg-[#1f2937]">
                            <tr class="border-b border-[#374151]">
                                <th class="text-left p-2">ID</th>
                                <th class="text-left p-2">Name</th>
                                <th class="text-left p-2">Email</th>
                                <th class="text-left p-2">Phone</th>
                                <th class="text-left p-2">Status</th>
                            </tr>
                        </thead>
                        <tbody id="dataTable">
                            <!-- Data rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Duplicate Groups Visualization -->
            <div class="mb-6">
                <h3 class="text-sm font-medium mb-2">Duplicate Groups</h3>
                <div id="duplicateGroups" class="space-y-2 max-h-32 overflow-y-auto">
                    <!-- Duplicate group info will be inserted here -->
                </div>
            </div>

            <!-- Strategy Impact -->
            <div>
                <h3 class="text-sm font-medium mb-2">Strategy Impact</h3>
                <div id="impactChart" class="space-y-2">
                    <!-- Impact bars will be inserted here -->
                </div>
            </div>

            <!-- Strategy Explanation -->
            <div id="strategyExplanation" class="mt-6 p-4 bg-[#101827] rounded border border-[#374151]">
                <h3 class="text-sm font-bold mb-2 text-[#8b5cf6]">How It Works</h3>
                <p class="text-xs text-[#9ca3af]">Select a strategy to see how it handles duplicate values in your dataset. Each approach has different trade-offs in terms of data preservation and accuracy.</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-[#1f2937] border-t border-[#374151] py-4 px-6 mt-auto">
        <div class="flex justify-center space-x-6">
            <a href="https://www.linkedin.com/in/ashish-jangra/" target="_blank" class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors">
                <i class="fab fa-linkedin fa-2x"></i>
            </a>
            <a href="https://github.com/AshishJangra27" target="_blank" class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors">
                <i class="fab fa-github fa-2x"></i>
            </a>
            <a href="https://www.kaggle.com/ashishjangra27" target="_blank" class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors">
                <i class="fab fa-kaggle fa-2x"></i>
            </a>
            <a href="https://huggingface.co/ashish-jangra" target="_blank" class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors">
                <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm0 2.4c5.302 0 9.6 4.298 9.6 9.6s-4.298 9.6-9.6 9.6S2.4 17.302 2.4 12 6.698 2.4 12 2.4z"/>
                    <path d="M8.4 9.6a1.2 1.2 0 1 1 2.4 0 1.2 1.2 0 0 1-2.4 0zm4.8 0a1.2 1.2 0 1 1 2.4 0 1.2 1.2 0 0 1-2.4 0z"/>
                    <path d="M7.2 14.4c0 2.64 2.16 4.8 4.8 4.8s4.8-2.16 4.8-4.8H7.2z"/>
                </svg>
            </a>
            <a href="https://www.instagram.com/ashish_zangra/" target="_blank" class="text-[#9ca3af] hover:text-[#a78bfa] transition-colors">
                <i class="fab fa-instagram fa-2x"></i>
            </a>
        </div>
    </footer>

    <script>
        // Application state
        let originalData = [];
        let currentData = [];
        let duplicateGroups = [];
        let selectedStrategy = null;
        let detectionCriteria = { name: true, email: true, phone: false };

        // Sample data for generation
        const sampleNames = ['John Smith', 'Jane Doe', 'Mike Johnson', 'Sarah Wilson', 'David Brown', 'Emily Davis', 'Chris Taylor', 'Lisa Anderson', 'Robert Miller', 'Jessica Garcia', 'Daniel Martinez', 'Ashley Rodriguez', 'Matthew Lopez', 'Amanda Clark', 'James Lewis'];
        const sampleEmails = ['john.smith@email.com', 'jane.doe@gmail.com', 'mike.j@yahoo.com', 'sarah.w@hotmail.com', 'david.brown@email.com', 'emily.davis@gmail.com', 'chris.t@company.com', 'lisa.a@domain.com'];
        const samplePhones = ['555-0101', '555-0102', '555-0103', '555-0104', '555-0105', '555-0106', '555-0107', '555-0108', '555-0109', '555-0110'];

        // DOM elements
        const rowSlider = document.getElementById('rowSlider');
        const rowCount = document.getElementById('rowCount');
        const duplicateSlider = document.getElementById('duplicateSlider');
        const duplicatePercent = document.getElementById('duplicatePercent');
        const dataTable = document.getElementById('dataTable');
        const duplicateGroupsDiv = document.getElementById('duplicateGroups');
        const impactChart = document.getElementById('impactChart');
        const statistics = document.getElementById('statistics');
        const strategyExplanation = document.getElementById('strategyExplanation');

        // Strategy buttons
        const strategyButtons = document.querySelectorAll('.strategy-button');
        const generateBtn = document.getElementById('generateBtn');
        const detectBtn = document.getElementById('detectBtn');
        const applyBtn = document.getElementById('applyBtn');
        const resetBtn = document.getElementById('resetBtn');

        // Checkboxes
        const checkName = document.getElementById('checkName');
        const checkEmail = document.getElementById('checkEmail');
        const checkPhone = document.getElementById('checkPhone');

        // Strategy explanations
        const strategyInfo = {
            keepFirst: {
                title: "Keep First Occurrence",
                description: "Retains the first occurrence of duplicate records and removes all subsequent duplicates. Simple and preserves chronological order.",
                pros: ["Maintains chronological order", "Simple to implement", "Consistent results"],
                cons: ["May keep incomplete records", "Ignores newer information"]
            },
            keepLast: {
                title: "Keep Last Occurrence",
                description: "Retains the last occurrence of duplicate records. Useful when newer records contain more up-to-date information.",
                pros: ["Preserves latest information", "Good for time-series data", "Simple logic"],
                cons: ["May lose historical context", "Assumes newer is better"]
            },
            keepComplete: {
                title: "Keep Most Complete",
                description: "Analyzes duplicate records and keeps the one with the most complete information (fewest null/empty fields).",
                pros: ["Maximizes data quality", "Intelligent selection", "Preserves valuable information"],
                cons: ["More complex logic", "May not handle ties well", "Computationally expensive"]
            },
            removeAll: {
                title: "Remove All Duplicates",
                description: "Removes all instances of duplicate records, including the original. Use when duplicate data indicates data quality issues.",
                pros: ["Ensures data uniqueness", "Conservative approach", "Eliminates ambiguity"],
                cons: ["High data loss", "May remove valid records", "Too aggressive for most cases"]
            },
            merge: {
                title: "Merge Information",
                description: "Combines information from all duplicate records into a single comprehensive record with complete data.",
                pros: ["No data loss", "Most complete records", "Intelligent handling"],
                cons: ["Complex implementation", "May create conflicts", "Requires conflict resolution rules"]
            }
        };

        // Initialize application
        function init() {
            generateData();
            setupEventListeners();
            updateUI();
        }

        // Setup event listeners
        function setupEventListeners() {
            rowSlider.addEventListener('input', function() {
                rowCount.textContent = this.value;
                generateData();
            });

            duplicateSlider.addEventListener('input', function() {
                duplicatePercent.textContent = this.value + '%';
                generateData();
            });

            // Detection criteria checkboxes
            checkName.addEventListener('change', function() {
                detectionCriteria.name = this.checked;
                if (!detectionCriteria.name && !detectionCriteria.email && !detectionCriteria.phone) {
                    this.checked = true;
                    detectionCriteria.name = true;
                }
                detectDuplicates();
            });

            checkEmail.addEventListener('change', function() {
                detectionCriteria.email = this.checked;
                if (!detectionCriteria.name && !detectionCriteria.email && !detectionCriteria.phone) {
                    this.checked = true;
                    detectionCriteria.email = true;
                }
                detectDuplicates();
            });

            checkPhone.addEventListener('change', function() {
                detectionCriteria.phone = this.checked;
                if (!detectionCriteria.name && !detectionCriteria.email && !detectionCriteria.phone) {
                    this.checked = true;
                    detectionCriteria.phone = true;
                }
                detectDuplicates();
            });

            strategyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    strategyButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    const strategyMap = {
                        'keepFirstStrategy': 'keepFirst',
                        'keepLastStrategy': 'keepLast',
                        'keepCompleteStrategy': 'keepComplete',
                        'removeAllStrategy': 'removeAll',
                        'mergeStrategy': 'merge'
                    };
                    
                    selectedStrategy = strategyMap[this.id];
                    updateStrategyExplanation();
                });
            });

            generateBtn.addEventListener('click', generateData);
            detectBtn.addEventListener('click', detectDuplicates);
            applyBtn.addEventListener('click', applyStrategy);
            resetBtn.addEventListener('click', resetData);
        }

        // Generate random dataset with duplicates
        function generateData() {
            const rows = parseInt(rowSlider.value);
            const duplicatePercentage = parseInt(duplicateSlider.value);
            
            originalData = [];
            const numDuplicates = Math.floor((rows * duplicatePercentage) / 100);
            const numUnique = rows - numDuplicates;
            
            // Generate unique records first
            for (let i = 1; i <= numUnique; i++) {
                const record = {
                    id: i,
                    name: sampleNames[Math.floor(Math.random() * sampleNames.length)],
                    email: sampleEmails[Math.floor(Math.random() * sampleEmails.length)],
                    phone: samplePhones[Math.floor(Math.random() * samplePhones.length)],
                    status: 'unique',
                    duplicateGroup: null,
                    isRemoved: false
                };
                originalData.push(record);
            }
            
            // Generate duplicates by copying existing records with variations
            for (let i = 0; i < numDuplicates; i++) {
                const sourceIndex = Math.floor(Math.random() * numUnique);
                const sourceRecord = originalData[sourceIndex];
                
                const duplicate = {
                    id: numUnique + i + 1,
                    name: sourceRecord.name,
                    email: sourceRecord.email,
                    phone: Math.random() > 0.7 ? samplePhones[Math.floor(Math.random() * samplePhones.length)] : sourceRecord.phone,
                    status: 'duplicate',
                    duplicateGroup: null,
                    isRemoved: false
                };
                
                // Sometimes make fields empty to create different completeness levels
                if (Math.random() > 0.8) duplicate.phone = '';
                if (Math.random() > 0.9) duplicate.email = '';
                
                originalData.push(duplicate);
            }
            
            // Shuffle the array
            for (let i = originalData.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [originalData[i], originalData[j]] = [originalData[j], originalData[i]];
            }
            
            // Reassign IDs to maintain order
            originalData.forEach((record, index) => {
                record.id = index + 1;
            });
            
            currentData = JSON.parse(JSON.stringify(originalData));
            duplicateGroups = [];
            detectDuplicates();
        }

        // Detect duplicates based on selected criteria
        function detectDuplicates() {
            duplicateGroups = [];
            const groupMap = new Map();
            
            currentData.forEach(record => {
                record.status = 'unique';
                record.duplicateGroup = null;
            });
            
            // Create keys based on detection criteria
            currentData.forEach((record, index) => {
                let key = '';
                if (detectionCriteria.name) key += record.name.toLowerCase() + '|';
                if (detectionCriteria.email) key += record.email.toLowerCase() + '|';
                if (detectionCriteria.phone) key += record.phone + '|';
                
                if (!groupMap.has(key)) {
                    groupMap.set(key, []);
                }
                groupMap.get(key).push(index);
            });
            
            // Identify duplicate groups
            let groupIndex = 0;
            groupMap.forEach((indices, key) => {
                if (indices.length > 1) {
                    duplicateGroups.push({
                        id: groupIndex + 1,
                        indices: indices,
                        key: key,
                        count: indices.length
                    });
                    
                    indices.forEach(index => {
                        currentData[index].status = 'duplicate';
                        currentData[index].duplicateGroup = groupIndex + 1;
                    });
                    
                    groupIndex++;
                }
            });
            
            updateUI();
        }

        // Apply selected strategy
        function applyStrategy() {
            if (!selectedStrategy) {
                alert('Please select a strategy first!');
                return;
            }

            switch (selectedStrategy) {
                case 'keepFirst':
                    applyKeepFirst();
                    break;
                case 'keepLast':
                    applyKeepLast();
                    break;
                case 'keepComplete':
                    applyKeepComplete();
                    break;
                case 'removeAll':
                    applyRemoveAll();
                    break;
                case 'merge':
                    applyMerge();
                    break;
            }

            updateUI();
            updateImpactVisualization();
        }

        // Strategy implementations
        function applyKeepFirst() {
            duplicateGroups.forEach(group => {
                const indices = [...group.indices].sort((a, b) => a - b);
                for (let i = 1; i < indices.length; i++) {
                    currentData[indices[i]].isRemoved = true;
                    currentData[indices[i]].status = 'removed';
                }
                currentData[indices[0]].status = 'kept';
            });
        }

        function applyKeepLast() {
            duplicateGroups.forEach(group => {
                const indices = [...group.indices].sort((a, b) => a - b);
                for (let i = 0; i < indices.length - 1; i++) {
                    currentData[indices[i]].isRemoved = true;
                    currentData[indices[i]].status = 'removed';
                }
                currentData[indices[indices.length - 1]].status = 'kept';
            });
        }

        function applyKeepComplete() {
            duplicateGroups.forEach(group => {
                let bestIndex = group.indices[0];
                let maxCompleteness = calculateCompleteness(currentData[bestIndex]);
                
                group.indices.forEach(index => {
                    const completeness = calculateCompleteness(currentData[index]);
                    if (completeness > maxCompleteness) {
                        maxCompleteness = completeness;
                        bestIndex = index;
                    }
                });
                
                group.indices.forEach(index => {
                    if (index !== bestIndex) {
                        currentData[index].isRemoved = true;
                        currentData[index].status = 'removed';
                    } else {
                        currentData[index].status = 'kept';
                    }
                });
            });
        }

        function applyRemoveAll() {
            duplicateGroups.forEach(group => {
                group.indices.forEach(index => {
                    currentData[index].isRemoved = true;
                    currentData[index].status = 'removed';
                });
            });
        }

        function applyMerge() {
            const toRemove = [];
            
            duplicateGroups.forEach(group => {
                const indices = [...group.indices].sort((a, b) => a - b);
                const keepIndex = indices[0];
                const mergedRecord = { ...currentData[keepIndex] };
                
                // Merge information from all duplicates
                indices.forEach(index => {
                    const record = currentData[index];
                    if (!mergedRecord.name && record.name) mergedRecord.name = record.name;
                    if (!mergedRecord.email && record.email) mergedRecord.email = record.email;
                    if (!mergedRecord.phone && record.phone) mergedRecord.phone = record.phone;
                });
                
                currentData[keepIndex] = { ...mergedRecord, status: 'kept' };
                
                for (let i = 1; i < indices.length; i++) {
                    currentData[indices[i]].isRemoved = true;
                    currentData[indices[i]].status = 'removed';
                }
            });
        }

        // Calculate record completeness
        function calculateCompleteness(record) {
            let score = 0;
            if (record.name && record.name.trim()) score++;
            if (record.email && record.email.trim()) score++;
            if (record.phone && record.phone.trim()) score++;
            return score;
        }

        // Reset data
        function resetData() {
            currentData = JSON.parse(JSON.stringify(originalData));
            selectedStrategy = null;
            strategyButtons.forEach(btn => btn.classList.remove('active'));
            detectDuplicates();
            updateStrategyExplanation();
        }

        // Update UI
        function updateUI() {
            updateDataTable();
            updateDuplicateGroups();
            updateStatistics();
        }

        // Update data table
        function updateDataTable() {
            dataTable.innerHTML = '';
            
            currentData.forEach((record, index) => {
                const tr = document.createElement('tr');
                tr.classList.add('data-row', 'border-b', 'border-[#374151]');
                
                if (record.status === 'duplicate') tr.classList.add('duplicate');
                if (record.status === 'unique') tr.classList.add('unique');
                if (record.status === 'kept') tr.classList.add('kept');
                if (record.status === 'removed') tr.classList.add('removed');
                
                const groupIndicator = record.duplicateGroup ? 
                    `<span class="duplicate-indicator duplicate-group-${record.duplicateGroup % 6 + 1}"></span>` : '';
                
                tr.innerHTML = `
                    <td class="p-2">${record.id}</td>
                    <td class="p-2">${groupIndicator}${record.name || '<span class="text-[#6b7280]">Empty</span>'}</td>
                    <td class="p-2">${record.email || '<span class="text-[#6b7280]">Empty</span>'}</td>
                    <td class="p-2">${record.phone || '<span class="text-[#6b7280]">Empty</span>'}</td>
                    <td class="p-2">
                        <span class="px-2 py-1 text-xs rounded ${getStatusColor(record.status)}">
                            ${record.status.toUpperCase()}
                        </span>
                    </td>
                `;
                
                dataTable.appendChild(tr);
            });
        }

        // Get status color class
        function getStatusColor(status) {
            switch (status) {
                case 'unique': return 'bg-[#059669] text-white';
                case 'duplicate': return 'bg-[#dc2626] text-white';
                case 'kept': return 'bg-[#0ea5e9] text-white';
                case 'removed': return 'bg-[#6b7280] text-white';
                default: return 'bg-[#374151] text-white';
            }
        }

        // Update duplicate groups visualization
        function updateDuplicateGroups() {
            duplicateGroupsDiv.innerHTML = '';
            
            if (duplicateGroups.length === 0) {
                duplicateGroupsDiv.innerHTML = '<p class="text-xs text-[#9ca3af]">No duplicate groups found</p>';
                return;
            }
            
            duplicateGroups.forEach(group => {
                const groupDiv = document.createElement('div');
                groupDiv.className = 'p-2 bg-[#101827] rounded border border-[#374151]';
                groupDiv.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-xs font-medium">
                            <span class="duplicate-indicator duplicate-group-${group.id % 6 + 1}"></span>
                            Group ${group.id}
                        </span>
                        <span class="text-xs text-[#9ca3af]">${group.count} records</span>
                    </div>
                    <div class="text-xs text-[#9ca3af] mt-1">
                        IDs: ${group.indices.map(i => currentData[i].id).join(', ')}
                    </div>
                `;
                duplicateGroupsDiv.appendChild(groupDiv);
            });
        }

        // Update statistics
        function updateStatistics() {
            const totalRecords = originalData.length;
            const activeRecords = currentData.filter(r => !r.isRemoved).length;
            const duplicateRecordsCount = duplicateGroups.reduce((sum, group) => sum + group.count, 0);
            const dataReduction = Math.round(((totalRecords - activeRecords) / totalRecords) * 100);

            document.getElementById('totalRecords').textContent = totalRecords;
            document.getElementById('duplicateGroups').textContent = duplicateGroups.length;
            document.getElementById('duplicateRecords').textContent = duplicateRecordsCount;
            document.getElementById('afterCleanup').textContent = activeRecords;
            document.getElementById('dataReduction').textContent = dataReduction + '%';
        }

        // Update impact visualization
        function updateImpactVisualization() {
            if (!selectedStrategy) return;

            impactChart.innerHTML = '';
            
            const activeRecords = currentData.filter(r => !r.isRemoved).length;
            const totalRecords = originalData.length;
            
            const metrics = [
                { 
                    label: 'Data Preservation', 
                    value: (activeRecords / totalRecords) * 100,
                    color: '#059669'
                },
                { 
                    label: 'Duplicate Removal', 
                    value: duplicateGroups.length > 0 ? (duplicateGroups.length / (duplicateGroups.length + (totalRecords - duplicateGroups.reduce((sum, g) => sum + g.count, 0)))) * 100 : 100,
                    color: '#dc2626'
                },
                { 
                    label: 'Data Quality', 
                    value: calculateDataQuality(),
                    color: '#8b5cf6'
                }
            ];

            metrics.forEach(metric => {
                const bar = document.createElement('div');
                bar.className = 'flex items-center space-x-2';
                bar.innerHTML = `
                    <span class="text-xs w-24">${metric.label}:</span>
                    <div class="flex-grow bg-[#374151] rounded-full h-3">
                        <div class="visualization-bar h-3 rounded-full transition-all duration-500" 
                             style="width: ${metric.value}%; background-color: ${metric.color}"></div>
                    </div>
                    <span class="text-xs text-[#9ca3af] w-10">${Math.round(metric.value)}%</span>
                `;
                impactChart.appendChild(bar);
            });
        }

        // Calculate data quality metric
        function calculateDataQuality() {
            const activeRecords = currentData.filter(r => !r.isRemoved);
            if (activeRecords.length === 0) return 0;
            
            const totalCompleteness = activeRecords.reduce((sum, record) => 
                sum + calculateCompleteness(record), 0);
            const maxPossibleCompleteness = activeRecords.length * 3; // 3 fields per record
            
            return (totalCompleteness / maxPossibleCompleteness) * 100;
        }

        // Update strategy explanation
        function updateStrategyExplanation() {
            if (!selectedStrategy) {
                strategyExplanation.innerHTML = `
                    <h3 class="text-sm font-bold mb-2 text-[#8b5cf6]">How It Works</h3>
                    <p class="text-xs text-[#9ca3af]">Select a strategy to see how it handles duplicate values in your dataset. Each approach has different trade-offs in terms of data preservation and accuracy.</p>
                `;
                return;
            }

            const info = strategyInfo[selectedStrategy];
            strategyExplanation.innerHTML = `
                <h3 class="text-sm font-bold mb-2 text-[#8b5cf6]">${info.title}</h3>
                <p class="text-xs text-[#9ca3af] mb-3">${info.description}</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="text-xs font-medium text-[#059669] mb-1">Pros:</h4>
                        <ul class="text-xs text-[#9ca3af] space-y-1">
                            ${info.pros.map(pro => `<li>• ${pro}</li>`).join('')}
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-xs font-medium text-[#dc2626] mb-1">Cons:</h4>
                        <ul class="text-xs text-[#9ca3af] space-y-1">
                            ${info.cons.map(con => `<li>• ${con}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
        }

        // Initialize the application
        init();
    </script>
</body>
</html>
